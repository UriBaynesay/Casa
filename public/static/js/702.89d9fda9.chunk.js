"use strict";(self.webpackChunkcasa=self.webpackChunkcasa||[]).push([[702],{6390:function(t,e,r){r.d(e,{X:function(){return i}});var n=r(4165),a=r(5861),s=r(7265),c="order",i={query:function(t){return u.apply(this,arguments)},saveOrder:function(t){return d.apply(this,arguments)},getById:function(t){return l.apply(this,arguments)},remove:function(t){return o.apply(this,arguments)},getUserOrdersStats:function(t){var e={};return t?(e.avgRating=p(t),e.totalRevenue=f(t),e.ordersStatus=h(t),e):{avgRating:0,totalRevenue:0,ordersStatus:{total:0,pending:0,accepted:0,declined:0}}}};function u(){return(u=(0,a.Z)((0,n.Z)().mark((function t(e){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.R.get(c,e);case 3:return r=t.sent,t.abrupt("return",r);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0.data;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function l(){return(l=(0,a.Z)((0,n.Z)().mark((function t(e){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.R.get("".concat(c,"/").concat(e));case 3:return r=t.sent,t.abrupt("return",r);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0.data;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function o(){return(o=(0,a.Z)((0,n.Z)().mark((function t(e){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.R.delete("".concat(c,"/").concat(e));case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),t.t0.data;case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))).apply(this,arguments)}function d(){return(d=(0,a.Z)((0,n.Z)().mark((function t(e){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._id){t.next=11;break}return t.prev=1,t.next=4,s.R.post(c,e);case 4:return r=t.sent,t.abrupt("return",r);case 8:throw t.prev=8,t.t0=t.catch(1),t.t0.data;case 11:return t.prev=11,t.next=14,s.R.put("".concat(c,"/").concat(e._id),e);case 14:return a=t.sent,t.abrupt("return",a);case 18:throw t.prev=18,t.t1=t.catch(11),t.t1.data;case 21:case"end":return t.stop()}}),t,null,[[1,8],[11,18]])})))).apply(this,arguments)}function p(t){return t.reduce((function(t,e){return t+e.stay.reviewScores.rating}),0)/t.length}function f(t){return t.reduce((function(t,e){return"accepted"===e.status?t+e.price:t}),0)}function h(t){return t.reduce((function(t,e){return t.total++,"pending"===e.status?t.pending++:"accepted"===e.status?t.accepted++:"declined"===e.status&&t.declined++,t}),{total:0,pending:0,accepted:0,declined:0})}},2702:function(t,e,r){r.r(e),r.d(e,{default:function(){return v}});var n=r(1413),a=r(4165),s=r(5861),c=r(885),i=r(2791),u=r(9434),l=r(184),o=function(t){var e=t.trip,r=t.onUpdateOrder;return(0,l.jsxs)(i.Fragment,{children:[(0,l.jsx)("div",{className:"stay-name",children:e.stay.name}),(0,l.jsx)("div",{className:"stay-address",children:e.stay.address.street}),(0,l.jsx)("div",{className:"host-fullname",children:e.stay.host.fullname}),(0,l.jsxs)("div",{className:"trip-total",children:["$ ",e.price]}),(0,l.jsx)("div",{className:"trip-start-date",children:new Date(e.startDate).toLocaleDateString()}),(0,l.jsx)("div",{className:"trip-end-date",children:new Date(e.endDate).toLocaleDateString()}),(0,l.jsx)("div",{className:"trip-status",children:e.status}),(0,l.jsx)("div",{className:"action-container",children:(0,l.jsx)("button",{className:"decline-btn",disabled:"declined"===e.status,onClick:function(){return r(e,"declined")},children:(0,l.jsx)("div",{children:"Cancel"})})})]})},d=function(t){var e=t.trips,r=t.onUpdateOrder;return(0,l.jsxs)("section",{className:"user-trips-list-container",children:[(0,l.jsx)("div",{className:"user-trips-table-titles-container",children:[{class:"stay-name-title",title:"Stay name"},{class:"stay-address-title",title:"Stay address"},{class:"user-fullname-title",title:"Owner name"},{class:"order-total-title",title:"Order total"},{class:"order-start-date-title",title:"Start date"},{class:"order-end-date-title",title:"End date"},{class:"order-status",title:"Status"},{class:"action-title",title:"Actions"}].map((function(t){return(0,l.jsx)("h4",{className:t.class,children:t.title})}))}),e.map((function(t){return(0,l.jsx)("div",{className:"user-trip-preview-container",children:(0,l.jsx)(o,{trip:t,onUpdateOrder:r})})}))]})},p=r(1280),f=r(6390),h=r(2506),v=function(){var t=(0,i.useState)([]),e=(0,c.Z)(t,2),r=e[0],o=e[1],v=(0,u.v9)((function(t){return t.userModule})).user;(0,i.useEffect)((function(){return p.LR.on(p.zb,x),x(),function(){p.LR.off(p.zb,x)}}),[]);var x=function(){var t=(0,s.Z)((0,a.Z)().mark((function t(){var e;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.X.query({userId:v._id});case 2:e=t.sent,o(e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=function(){var t=(0,s.Z)((0,a.Z)().mark((function t(e,r){var s;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=(0,n.Z)((0,n.Z)({},e),{},{status:r}),t.prev=1,t.next=4,f.X.saveOrder(s);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.error(t.t0);case 9:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e,r){return t.apply(this,arguments)}}();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.t,{}),(0,l.jsx)("main",{className:"user-profile main-layout",children:(0,l.jsxs)("section",{className:"user-trips-container",children:[(0,l.jsx)("h2",{children:"Your trips"}),r.length?(0,l.jsx)(d,{trips:r,onUpdateOrder:m}):(0,l.jsx)("p",{children:"No trips"})]})})]})}}}]);
//# sourceMappingURL=702.89d9fda9.chunk.js.map